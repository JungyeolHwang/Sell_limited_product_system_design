자주 하는 실수 4가지 (피하면 합격각)

SELECT … FOR UPDATE로 재고 읽고 계산 후 UPDATE 두 번에 나눠서 함 → 레이스 생김.
→ **반드시 “조건부 한 방 UPDATE”**로.

리플리카/캐시에서 재고 읽고 결정 → 래그 때문에 초과주문.
→ 결정은 주 DB 트랜잭션에서만.

재고만 깎고 예약 미생성(또는 반대) → 유령/허수 상태.
→ 3과 4를 같은 트랜잭션으로.

멱등성 없이 게이트웨이 재시도 허용 → 중복 차감.
→ 트랜잭션 첫 줄에서 멱등성 등록.