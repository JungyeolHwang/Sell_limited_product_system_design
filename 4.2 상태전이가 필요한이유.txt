“상태 전이(state transition)”라는 말이 낯설게 느껴지실 수 있는데, 쉽게 풀어볼게요.

1. 상태 전이가 뭐냐?

한 객체(여기서는 예약)가 시간이 지나면서 **상태(Status)**가 변하는 걸 말해요.

예: HOLD → COMMITTED → EXPIRED

마치 신호등이 초록 → 노랑 → 빨강으로 바뀌듯이,
예약도 처음엔 잡힘(HOLD) → 결제 성공(COMMITTED) → 결제 안 되면 만료(EXPIRED) 로 흘러갑니다.

즉, 행을 지우지 않고 status 컬럼 값만 바꾸는 것이 “상태 전이”예요.

2. 왜 상태 전이가 필요한가?
(1) 추적 가능성

만약 DELETE로 행을 지워버리면 “이 예약이 왜 실패했는지” 기록이 사라집니다.

반면 status='EXPIRED'로 남기면 “이 사람이 언제 예약했지만 결제 안 해서 만료됐다”라는 이력 추적이 가능해집니다.

(2) 동시성 충돌 방지

결제(T2)와 만료(T3)가 동시에 실행될 수 있습니다.

T3가 먼저 DELETE 하면, T2는 “예약이 없다”고 보고 결제를 실패 처리합니다 → 고객 피해.

대신 status=EXPIRED로만 바꾸면, T2는 “아, 이미 만료 상태구나”라고 안전하게 실패 처리합니다.

(3) 원장(ledger)와 데이터 정합성

재고는 항상 “왜 늘었고 줄었는지” 기록이 있어야 합니다.

DELETE하면 원장에 대응되는 증거 행이 사라져서, 장애나 재조정 시 맞추기 어려워져요.

status 전이로 남겨두면, 언제든지 원장과 대조할 수 있습니다.

✅ 한마디로:
**“상태 전이 = 삭제 대신 상태값을 바꿔서, 이력 추적·동시성 안전·원장 정합성을 지키는 방법”**이에요.